Dim ws As Worksheet


Private Sub cmdAdd_click()
Set ws = Sheet1

Dim lastrow As Long

lastrow = ws.Range("A" & Rows.Count).End(xlUp).Row + 1

With ws
.Cells(lastrow, 1).Value = TextBox1.Value
.Cells(lastrow, 2).Value = TextBox2.Value
.Cells(lastrow, 3).Value = ComboBox1.Value
End With
ActiveWorkbook.Save
MsgBox "Entry Save"




End Sub


Private Sub cmddelete_Click()

Set ws = Sheet1

Dim idrow As Long

For idrow = 2 To ws.Range("a" & Rows.Count).End(xlUp).Row

'txtsearch
If ws.Cells(idrow, 1).Value = txtsearch.Text Then

ws.Rows(idrow).Delete Shift:=xlUp

End If
Next idrow


End Sub

Private Sub cmdSearch_Click()

Set ws = Sheet1

Dim idrow As Long

For idrow = 2 To ws.Range("a" & Rows.Count).End(xlUp).Row

'txtsearch
If ws.Cells(idrow, 1).Value = txtsearch.Text Then

TextBox1.Value = ws.Cells(idrow, 1)
TextBox2.Value = ws.Cells(idrow, 2)
ComboBox1.Value = ws.Cells(idrow, 3)
End If
Next idrow



End Sub


Private Sub cmdupdate_Click()

Set ws = Sheet1

Dim idrow As Long

For idrow = 2 To ws.Range("a" & Rows.Count).End(xlUp).Row

'txtsearch
If ws.Cells(idrow, 1).Value = txtsearch.Text Then
ws.Cells(idrow, 1) = TextBox1.Value
ws.Cells(idrow, 2) = TextBox2.Value
ws.Cells(idrow, 3) = ComboBox1.Value

End If
Next idrow


End Sub


Private Sub UserForm_Initialize()

ComboBox1.List = Array("male", "female")
TextBox1 = Application.WorksheetFunction.Max(Sheet1.Range("A:A")) + 1




End Sub
